import { crypto_kdf_hkdf_sha256_expand, crypto_kdf_hkdf_sha256_extract } from "@/sdk/cipher/sodium";

const ikm = new Uint8Array([
    0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,
    0x08, 0x09, 0x0A, 0x0B, 0x0C, 0x0D, 0x0E, 0x0F
]);

/** The salt needs to be 32 bytes */
const salt = new Uint8Array([
    0x80, 0x81, 0x82, 0x83, 0x84, 0x85, 0x86, 0x87,
    0x88, 0x89, 0x8A, 0x8B, 0x8C, 0x8D, 0x8E, 0x8F,
    0x90, 0x91, 0x92, 0x93, 0x94, 0x95, 0x96, 0x97,
    0x98, 0x99, 0x9A, 0x9B, 0x9C, 0x9D, 0x9E, 0x9F
]);

const context = new Uint8Array([
    0x90, 0x91, 0x92, 0x93, 0x94, 0x95, 0x96, 0x97,
    0x98, 0x99, 0x9A, 0x9B, 0x9C, 0x9D, 0x9E, 0x9F
]);

const prk = crypto_kdf_hkdf_sha256_extract(salt, ikm);

console.log('PRK:', Array.from(prk).map(b => b.toString(16).padStart(2, '0')).join(''));

const key = crypto_kdf_hkdf_sha256_expand(32, context, prk);

console.log('Expanded Key:', Array.from(key).map(b => b.toString(16).padStart(2, '0')).join(''));

